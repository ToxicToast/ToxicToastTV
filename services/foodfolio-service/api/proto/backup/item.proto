syntax = "proto3";

package foodfolio.v1;

option go_package = "toxictoast/services/foodfolio-service/api/proto/foodfolio/v1;foodfoliov1";

import "common.proto";
import "category.proto";
import "company.proto";
import "type.proto";

// Item (Base Product) message
message Item {
  string id = 1;
  string name = 2; // "Monster Energy", "Coca-Cola"
  string slug = 3;
  string category_id = 4;
  string company_id = 5;
  string type_id = 6;
  Timestamps timestamps = 7;

  // Optional relations
  optional Category category = 8;
  optional Company company = 9;
  optional Type type = 10;
  int32 variant_count = 11; // Number of variants
}

// Create item request
message CreateItemRequest {
  string name = 1;
  string category_id = 2;
  string company_id = 3;
  string type_id = 4;
}

// Create item response
message CreateItemResponse {
  Item item = 1;
}

// Get item response
message GetItemResponse {
  Item item = 1;
}

// Get item with variants request
message GetItemWithVariantsRequest {
  string id = 1;
  bool include_details = 2; // Include ItemDetails for each variant
}

// Get item with variants response (defined in item_variant.proto)

// List items request
message ListItemsRequest {
  optional string category_id = 1;    // Filter by category
  optional string company_id = 2;     // Filter by company
  optional string type_id = 3;        // Filter by type
  optional string search = 4;         // Search by name
  PaginationRequest pagination = 5;
  DeletedFilter deleted_filter = 6;
}

// List items response
message ListItemsResponse {
  repeated Item items = 1;
  PaginationResponse pagination = 2;
}

// Update item request
message UpdateItemRequest {
  string id = 1;
  optional string name = 2;
  optional string category_id = 3;
  optional string company_id = 4;
  optional string type_id = 5;
}

// Update item response
message UpdateItemResponse {
  Item item = 1;
}

// Search items request
message SearchItemsRequest {
  string query = 1;
  optional string category_id = 2;
  optional string company_id = 3;
  PaginationRequest pagination = 4;
}

// Search items response
message SearchItemsResponse {
  repeated Item items = 1;
  PaginationResponse pagination = 2;
}

// Item service
service ItemService {
  rpc CreateItem(CreateItemRequest) returns (CreateItemResponse);
  rpc GetItem(IdRequest) returns (GetItemResponse);
  rpc ListItems(ListItemsRequest) returns (ListItemsResponse);
  rpc UpdateItem(UpdateItemRequest) returns (UpdateItemResponse);
  rpc DeleteItem(IdRequest) returns (SuccessResponse);
  rpc SearchItems(SearchItemsRequest) returns (SearchItemsResponse);
}
