syntax = "proto3";

package foodfolio.v1;

option go_package = "toxictoast/services/foodfolio-service/api/proto/foodfolio/v1;foodfoliov1";

import "common.proto";

// Category message
message Category {
  string id = 1;
  string name = 2;
  string slug = 3;
  optional string parent_id = 4;
  Timestamps timestamps = 5;

  // Optional relations
  optional Category parent = 6;
  repeated Category children = 7;
  int32 item_count = 8; // Number of items in this category
}

// Create category request
message CreateCategoryRequest {
  string name = 1;
  optional string parent_id = 2;
}

// Create category response
message CreateCategoryResponse {
  Category category = 1;
}

// Get category request (uses IdRequest from common.proto)

// Get category response
message GetCategoryResponse {
  Category category = 1;
}

// List categories request
message ListCategoriesRequest {
  optional string parent_id = 1; // Filter by parent (null = root categories)
  bool include_children = 2;     // Include children in response
  PaginationRequest pagination = 3;
  DeletedFilter deleted_filter = 4;
}

// List categories response
message ListCategoriesResponse {
  repeated Category categories = 1;
  PaginationResponse pagination = 2;
}

// Update category request
message UpdateCategoryRequest {
  string id = 1;
  optional string name = 2;
  optional string parent_id = 3; // Set to empty string to remove parent
}

// Update category response
message UpdateCategoryResponse {
  Category category = 1;
}

// Delete category request (uses IdRequest from common.proto)

// Delete category response (uses SuccessResponse from common.proto)

// Get category tree request
message GetCategoryTreeRequest {
  optional string root_id = 1; // Start from specific category, or null for full tree
  int32 max_depth = 2;         // Maximum depth to fetch (0 = unlimited)
}

// Get category tree response
message GetCategoryTreeResponse {
  repeated Category categories = 1; // Root categories with nested children
}

// Category service
service CategoryService {
  rpc CreateCategory(CreateCategoryRequest) returns (CreateCategoryResponse);
  rpc GetCategory(IdRequest) returns (GetCategoryResponse);
  rpc ListCategories(ListCategoriesRequest) returns (ListCategoriesResponse);
  rpc UpdateCategory(UpdateCategoryRequest) returns (UpdateCategoryResponse);
  rpc DeleteCategory(IdRequest) returns (SuccessResponse);
  rpc GetCategoryTree(GetCategoryTreeRequest) returns (GetCategoryTreeResponse);
}
